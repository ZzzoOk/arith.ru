(this["webpackJsonparith.ru"]=this["webpackJsonparith.ru"]||[]).push([[0],{124:function(e,t,n){e.exports={leaderboard:"Leaderboard_leaderboard__3ylgd",currentUser:"Leaderboard_currentUser__2bDSQ"}},174:function(e,t,n){},204:function(e,t,n){},374:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(46),s=n.n(a),o=(n(204),n(31)),i=n(19),l=n(26),u=n(80),j=n.n(u),d=n(2),h=function(){var e=Object(l.c)((function(e){return e.user.isAuth}));return Object(d.jsx)("nav",{id:j.a.menu,children:Object(d.jsxs)("ul",{children:[Object(d.jsx)("li",{children:Object(d.jsx)(o.b,{exact:!0,to:"/",activeClassName:j.a.active,children:Object(d.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",viewBox:"0 0 16 16",children:[Object(d.jsx)("path",{d:"m 8 3.293 l 6 6 V 13.5 a 1.5 1.5 0 0 1 -1.5 1.5 h -9 A 1.5 1.5 0 0 1 2 13.5 V 9.293 l 6 -6 z"}),Object(d.jsx)("path",{d:"M7.293 1.5a1 1 0 0 1 1.414 0l6.647 6.646a.5.5 0 0 1-.708.708L8 2.207 1.354 8.854a.5.5 0 1 1-.708-.708L7.293 1.5z"})]})})}),Object(d.jsx)("li",{children:Object(d.jsx)(o.b,{to:"/leaderboard",activeClassName:j.a.active,children:Object(d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",viewBox:"0 0 16 16",children:Object(d.jsx)("path",{d:"m 1 10 h 4 v 5 H 1 v -5 z M 6 1 h 4 v 14 H 6 V 1 z m 5 5 h 4 v 9 h -4 V 6 z"})})})}),Object(d.jsx)("li",{children:Object(d.jsx)(o.b,{to:e?"/profile":"/login",activeClassName:j.a.active,children:Object(d.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",viewBox:"0 0 16 16",children:[Object(d.jsx)("path",{d:"M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"}),Object(d.jsx)("path",{d:"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"})]})})})]})})},b=n(12),O=n(24),m=n.n(O),p=n(55),x=n(56),f=n.n(x),g="SET_USER",v="LOGOUT",w={username:"anon",isAuth:!1};var k=function(e){return{type:g,payload:e}},S=function(){var e=Object(p.a)(m.a.mark((function e(t,n,r){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("https://arith-ru.herokuapp.com/signup",{username:t,email:n,password:r}).then((function(e){alert(e.data.message)})).catch((function(e){alert(e.response.data.message)}));case 2:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),y=function(){var e=Object(p.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("https://arith-ru.herokuapp.com/get",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},params:{questionCount:t}}).then((function(e){localStorage.setItem("results"+t,JSON.stringify(e.data))})).catch((function(e){}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(p.a)(m.a.mark((function e(t,n,r){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("https://arith-ru.herokuapp.com/set",{date:t,result:n,questionCount:r},{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}).catch((function(e){}));case 2:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),N=function(){var e=Object(p.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("https://arith-ru.herokuapp.com/leaders",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},params:{questionCount:t}}).then((function(e){localStorage.setItem("leaderboard"+t,JSON.stringify({leaders:e.data,date:new Date}))})).catch((function(e){}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=n(173),_=n.n(I),A=n(66),D=n.n(A),M=function(){var e,t,n,c=Object(r.useState)("1 + 1"),a=Object(b.a)(c,2),s=a[0],o=a[1],i=Object(r.useState)(0),l=Object(b.a)(i,2),u=l[0],j=l[1],h=Object(r.useState)(),O=Object(b.a)(h,2),m=O[0],p=O[1],x=Object(r.useState)(!1),f=Object(b.a)(x,2),g=f[0],v=f[1],w=Object(r.useState)(),k=Object(b.a)(w,2),S=k[0],y=k[1],N=null!==(e=localStorage.getItem("questionCount"))&&void 0!==e?e:50,I=null!==(t=JSON.parse(localStorage.getItem("results"+N)))&&void 0!==t?t:[],A=function(){return Math.floor(9*Math.random())+1},M=function(){if(u==N){var e=new Date,t={date:e,result:(e-m)/1e3};return I.push(t),localStorage.setItem("results"+N,JSON.stringify(I)),v(!0),C(t.date,t.result,N),void L()}m||p(new Date),n="",function(){var e=A(),t=A();o("".concat(e," + ").concat(t))}(),j(u+1)},U=function(e){var t,r;n+=null!==(t=null===(r=e.target)||void 0===r?void 0:r.innerText)&&void 0!==t?t:e;var c=function(){var e=s.split("+"),t=Object(b.a)(e,2);return+t[0]+ +t[1]+""}();c.startsWith(n)&&c==n?M():(!c.startsWith(n)||n.length>=c.length)&&(n="",y(D.a.incorrect),setTimeout((function(){y()}),250))},L=function(){n="",p(),o("1 + 1"),j(0)},q=function(e){isFinite(e.key)&&32!=e.keyCode&&U(e.key),35==e.keyCode&&L()};return Object(r.useEffect)((function(){return n="",document.addEventListener("keydown",q),function(){document.removeEventListener("keydown",q)}})),Object(d.jsxs)("main",{id:D.a.main,children:[Object(d.jsxs)("table",{children:[Object(d.jsx)("caption",{id:D.a.question,className:S,onClick:L,children:s}),Object(d.jsxs)("tbody",{children:[Object(d.jsxs)("tr",{children:[Object(d.jsx)("td",{children:Object(d.jsx)("span",{className:"button",onClick:U,children:"7"})}),Object(d.jsx)("td",{children:Object(d.jsx)("span",{className:"button",onClick:U,children:"8"})}),Object(d.jsx)("td",{children:Object(d.jsx)("span",{className:"button",onClick:U,children:"9"})})]}),Object(d.jsxs)("tr",{children:[Object(d.jsx)("td",{children:Object(d.jsx)("span",{className:"button",onClick:U,children:"4"})}),Object(d.jsx)("td",{children:Object(d.jsx)("span",{className:"button",onClick:U,children:"5"})}),Object(d.jsx)("td",{children:Object(d.jsx)("span",{className:"button",onClick:U,children:"6"})})]}),Object(d.jsxs)("tr",{children:[Object(d.jsx)("td",{children:Object(d.jsx)("span",{className:"button",onClick:U,children:"1"})}),Object(d.jsx)("td",{children:Object(d.jsx)("span",{className:"button",onClick:U,children:"2"})}),Object(d.jsx)("td",{children:Object(d.jsx)("span",{className:"button",onClick:U,children:"3"})})]}),Object(d.jsx)("tr",{children:Object(d.jsx)("td",{colSpan:"3",children:Object(d.jsx)("span",{id:D.a.btn0,className:"button",onClick:U,children:"0"})})})]}),Object(d.jsx)("tfoot",{children:Object(d.jsx)("tr",{children:Object(d.jsx)("td",{id:D.a.counter,colSpan:"3",children:"".concat(u,"/").concat(N)})})})]}),Object(d.jsxs)(_.a,{isOpen:g,style:{content:{top:"30%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)"}},onRequestClose:function(){return v(!1)},children:[I.length>0&&Object(d.jsxs)("div",{children:["Your result: ",I[I.length-1].result," sec"]}),function(){if(I.length<2)return!1;var e=I[I.length-1].result;return I.every((function(t){return t.result>=e}))}()&&Object(d.jsx)("div",{children:"It's personal best!"}),I.length>1&&Object(d.jsxs)("div",{children:["Previous: ",I[I.length-2].result]})]})]})},U=n(124),L=n.n(U),q=function(e){var t=Object(l.c)((function(e){return e.user.username}));if(!e.leaders)return null;var n={hour:"numeric",minute:"numeric",second:"numeric",year:"numeric",month:"numeric",day:"numeric"};return e.leaders.sort((function(e,t){return e.result-t.result})).map((function(e){return Object(d.jsxs)("tr",{className:e.username==t?L.a.currentUser:null,children:[Object(d.jsx)("td",{children:e.username}),Object(d.jsx)("td",{children:new Intl.DateTimeFormat("default",n).format(new Date(e.date))}),Object(d.jsx)("td",{children:e.result})]})}))},z=function(){var e,t,n=Object(r.useState)(null!==(e=localStorage.getItem("questionCount"))&&void 0!==e?e:50),c=Object(b.a)(n,2),a=c[0],s=c[1],o=null!==(t=JSON.parse(localStorage.getItem("leaderboard"+a)))&&void 0!==t?t:[],i=function(e){e>0&&e<101&&s(e)};return Object(r.useEffect)((function(){(o.length<1||new Date-new Date(o.date)>3e5)&&N(a)})),Object(d.jsx)("main",{children:Object(d.jsxs)("table",{id:L.a.leaderboard,children:[Object(d.jsxs)("caption",{children:[Object(d.jsx)("h2",{children:"Leaderboard"}),Object(d.jsxs)("h3",{children:["Questions: ",a]}),Object(d.jsx)("span",{className:"button",onClick:function(){return i(+a-1)},children:"Prev"}),"|",Object(d.jsx)("span",{className:"button",onClick:function(){return i(+a+1)},children:"Next"})]}),Object(d.jsx)("thead",{children:Object(d.jsxs)("tr",{children:[Object(d.jsx)("th",{children:"Username"}),Object(d.jsx)("th",{children:"Date"}),Object(d.jsx)("th",{children:"Result (sec)"})]})}),Object(d.jsx)("tbody",{children:Object(d.jsx)(q,{leaders:o.leaders})})]})})},E=n(174),V=n.n(E),B=n(79),F=function(e){return Object(d.jsx)("input",Object(B.a)({onChange:function(t){return e.setValue(t.target.value)}},e))},J=n(376),T=n(377),R=n(381),K=n(190),P=n(191),Q=n(83),H=n(195),W=function(){var e,t=Object(l.c)((function(e){return e.user.username})),n=Object(r.useState)(null!==(e=localStorage.getItem("questionCount"))&&void 0!==e?e:50),c=Object(b.a)(n,2),a=c[0],s=c[1],o=JSON.parse(localStorage.getItem("results"+a)),u=Object(l.b)(),j=Object(i.e)(),h=function(e){if("auto"===e)return null;return new Intl.DateTimeFormat("default",{hour:"numeric",minute:"numeric",second:"numeric",year:"numeric",month:"numeric",day:"numeric"}).format(new Date(e))};return Object(r.useEffect)((function(){localStorage.getItem("results"+a)&&"[]"!=localStorage.getItem("results"+a)||y(a)})),Object(d.jsxs)("main",{id:V.a.main,children:[Object(d.jsx)("h2",{children:t}),Object(d.jsx)("label",{htmlFor:"count",children:Object(d.jsx)("h3",{children:"Questions:"})}),Object(d.jsx)(F,{type:"number",name:"count",value:a,setValue:s,onInput:function(e){var t=e.target.value;t=(t=t<1?1:t)>100?100:t,localStorage.setItem("questionCount",t)},min:"1",max:"100"}),Object(d.jsx)(J.a,{height:400,children:Object(d.jsxs)(T.a,{data:o,margin:{top:20,right:20,bottom:20,left:0},children:[Object(d.jsx)(R.a,{vertical:!1}),Object(d.jsx)(K.a,{dataKey:"date",tickFormatter:h,dy:15}),Object(d.jsx)(P.a,{domain:["auto","auto"]}),Object(d.jsx)(Q.a,{itemStyle:{color:"black",backgroundColor:"white"},labelFormatter:h,contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.8)"}}),Object(d.jsx)(H.a,{dataKey:"result"})]})}),Object(d.jsx)("span",{className:"button",onClick:function(){u({type:v}),j.push("/login")},children:"Log Out"})]})},G=function(){var e=Object(r.useState)(""),t=Object(b.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),s=Object(b.a)(a,2),l=s[0],u=s[1],j=Object(r.useState)(""),h=Object(b.a)(j,2),O=h[0],m=h[1],p=Object(i.e)();return Object(d.jsxs)("main",{children:[Object(d.jsx)("h2",{children:"Sign Up"}),Object(d.jsx)(F,{value:n,setValue:c,type:"text",placeholder:"Username"}),Object(d.jsx)("span",{className:"errorAlert hidden",children:"Username already taken"}),Object(d.jsx)("span",{className:"errorAlert hidden",children:"Only letters and numbers are allowed"}),Object(d.jsx)(F,{value:l,setValue:u,type:"email",placeholder:"Email"}),Object(d.jsx)("span",{className:"errorAlert hidden",children:"Another account is using this email"}),Object(d.jsx)(F,{value:O,setValue:m,type:"password",placeholder:"Password"}),Object(d.jsx)("span",{className:"errorAlert hidden",children:"Use from 6 to 15 characters"}),Object(d.jsx)("div",{children:Object(d.jsx)("span",{className:"button",onClick:function(){S(n,l,O),p.push("/login")},children:"Sign Up"})}),Object(d.jsx)("div",{className:"links",children:Object(d.jsx)(o.b,{to:"/login",children:"Log In"})})]})},Y=function(){var e=Object(r.useState)(""),t=Object(b.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),s=Object(b.a)(a,2),u=s[0],j=s[1],h=Object(l.b)(),O=Object(i.e)(),x=function(e){13==e.keyCode&&g()},g=function(){h(function(e,t){return function(){var n=Object(p.a)(m.a.mark((function n(r){return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f.a.post("https://arith-ru.herokuapp.com/login",{username:e,password:t}).then((function(e){r(k(e.data.username)),localStorage.setItem("token",e.data.token),window.location.reload()})).catch((function(){alert("Failed to log in")}));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(n,u))};return Object(r.useEffect)((function(){localStorage.getItem("token")&&O.push("/profile")})),Object(d.jsxs)("main",{children:[Object(d.jsx)("h2",{children:"Log In"}),Object(d.jsx)(F,{value:n,setValue:c,type:"text",placeholder:"Username or email",onKeyDown:x}),Object(d.jsx)(F,{value:u,setValue:j,type:"password",placeholder:"Password",onKeyDown:x}),Object(d.jsx)("span",{className:"button",onClick:g,children:"Log In"}),Object(d.jsx)("div",{className:"links",children:Object(d.jsx)(o.b,{to:"/resetpassword",children:"Reset password"})}),Object(d.jsx)("div",{className:"links",children:Object(d.jsx)(o.b,{to:"/signup",children:"Sign Up"})})]})};var Z=function(){var e=Object(l.c)((function(e){return e.user.isAuth})),t=Object(l.b)();return Object(r.useEffect)((function(){t(function(){var e=Object(p.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("https://arith-ru.herokuapp.com/auth",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}).then((function(e){t(k(e.data.username)),localStorage.setItem("token",e.data.token)})).catch((function(e){localStorage.removeItem("token")}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})),Object(d.jsxs)(o.a,{children:[Object(d.jsx)("header",{children:Object(d.jsx)(h,{})}),Object(d.jsx)(i.a,{exact:!0,path:"/",component:M}),Object(d.jsx)(i.a,{path:"/leaderboard",component:z}),e?Object(d.jsx)(i.a,{path:"/profile",component:W}):Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(i.a,{path:"/login",component:Y}),Object(d.jsx)(i.a,{path:"/signup",component:G})]}),Object(d.jsx)("footer",{})]})},X=n(76),$=n(192),ee=n(193),te=Object(X.combineReducers)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return{username:t.payload,isAuth:!0};case v:return localStorage.clear(),{username:"anon",isAuth:!1};default:return e}}}),ne=Object(X.createStore)(te,Object($.composeWithDevTools)(Object(X.applyMiddleware)(ee.a)));s.a.render(Object(d.jsx)(c.a.StrictMode,{children:Object(d.jsx)(l.a,{store:ne,children:Object(d.jsx)(Z,{})})}),document.getElementById("root"))},66:function(e,t,n){e.exports={question:"Main_question__ByQyq",main:"Main_main__1Ho6U",btn0:"Main_btn0__1Zex9",counter:"Main_counter__1ksg2",incorrect:"Main_incorrect__2AGZl"}},80:function(e,t,n){e.exports={active:"Menu_active__2YLX4"}}},[[374,1,2]]]);
//# sourceMappingURL=main.30c15e32.chunk.js.map